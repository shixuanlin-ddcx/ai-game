<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”¥ çŠŸè„¾æ°”ç”Ÿå­˜æŒ‘æˆ˜ - å‹åŠ›ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b69 50%, #0f0f23 100%);
            min-height: 100vh;
            color: white;
            overflow: hidden;
        }

        #gameContainer {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .hud {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-bottom: 2px solid #ff4757;
            z-index: 100;
        }

        .hud-left, .hud-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .hud-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
        }

        .hud-label {
            font-size: 0.8em;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .hud-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #ff4757;
        }



        .challenge-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            position: relative;
        }

        .challenge-text {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
            to { text-shadow: 0 0 20px #ff4757, 2px 2px 4px rgba(0,0,0,0.8); }
        }

        .choices-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            width: 100%;
            max-width: 800px;
        }

        .choice-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .choice-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .choice-card:hover:before {
            left: 100%;
        }

        .choice-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 71, 87, 0.3);
        }

        .choice-hard {
            border-color: #ff4757;
        }

        .choice-hard:hover {
            border-color: #ff3838;
            box-shadow: 0 10px 30px rgba(255, 71, 87, 0.5);
        }

        .choice-compromise {
            border-color: #ffa502;
        }

        .choice-compromise:hover {
            border-color: #ff9500;
            box-shadow: 0 10px 30px rgba(255, 165, 2, 0.5);
        }

        .choice-escape {
            border-color: #3742fa;
        }

        .choice-escape:hover {
            border-color: #2f3542;
            box-shadow: 0 10px 30px rgba(55, 66, 250, 0.5);
        }

        .choice-text {
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 15px;
        }

        .choice-risk {
            text-align: center;
            font-size: 0.9em;
            opacity: 0.8;
        }

        .risk-high { color: #ff4757; }
        .risk-medium { color: #ffa502; }
        .risk-low { color: #2ed573; }

        .streak-counter {
            position: fixed;
            top: 50%;
            right: 30px;
            transform: translateY(-50%);
            text-align: center;
            z-index: 50;
        }

        .streak-flame {
            font-size: 3em;
            animation: flicker 0.5s ease-in-out infinite alternate;
        }

        @keyframes flicker {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        .streak-text {
            font-size: 1.2em;
            margin-top: 10px;
            color: #ffa502;
        }

        @keyframes streakPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1b69 50%, #0f0f23 100%);
        }

        .title {
            font-size: 4em;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ff4757, #ffa502, #2ed573);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titleGlow 2s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            from { filter: brightness(1); }
            to { filter: brightness(1.3); }
        }

        .subtitle {
            font-size: 1.5em;
            margin-bottom: 30px;
            opacity: 0.8;
        }

        .start-btn {
            padding: 20px 50px;
            font-size: 1.5em;
            background: linear-gradient(45deg, #ff4757, #ff3838);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
        }

        .start-btn:hover {
            background: linear-gradient(45deg, #ff3838, #ff2f2f);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 71, 87, 0.6);
        }

        .game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
        }

        .game-over-content {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 50px;
            border-radius: 20px;
            border: 2px solid #ff4757;
            backdrop-filter: blur(10px);
        }

        .final-score {
            font-size: 3em;
            margin-bottom: 20px;
            color: #ffa502;
        }

        .restart-btn {
            padding: 15px 30px;
            font-size: 1.2em;
            background: linear-gradient(45deg, #2ed573, #20bf6b);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .restart-btn:hover {
            background: linear-gradient(45deg, #20bf6b, #17a2b8);
            transform: translateY(-2px);
        }

        .level-up {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ffa502, #ff9500);
            color: white;
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            z-index: 999;
            animation: levelUp 2s ease-out;
        }

        @keyframes levelUp {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .multiplier {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: rgba(255, 165, 2, 0.8);
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: bold;
            z-index: 50;
            animation: multiplierPulse 1s ease-in-out infinite;
        }

        @keyframes multiplierPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes aiCommentSlide {
            0% { transform: translateX(-50%) translateY(100px); opacity: 0; }
            20% { transform: translateX(-50%) translateY(0); opacity: 1; }
            80% { transform: translateX(-50%) translateY(0); opacity: 1; }
            100% { transform: translateX(-50%) translateY(-50px); opacity: 0; }
        }

        @keyframes eventFlash {
            0% { background: rgba(255, 255, 255, 1); }
            100% { background: rgba(0, 0, 0, 0.7); }
        }

        @keyframes eventPop {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes feedbackPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }


    </style>
</head>
<body>
    <div id="startScreen" class="start-screen">
        <div class="title">ğŸ”¥ çŠŸè„¾æ°”ç”Ÿå­˜æŒ‘æˆ˜</div>
        <div class="subtitle">æ— å‹åŠ›æŒ‘æˆ˜ä½ çš„åšæŒæé™ï¼</div>
        <p style="max-width: 600px; line-height: 1.6; margin-bottom: 30px;">
            ä½ å°†é¢ä¸´ä¸€ç³»åˆ—æŒ‘æˆ˜ï¼Œä»”ç»†æ€è€ƒæ¯ä¸ªé€‰æ‹©ï¼<br>
            è¿ç»­æ­£ç¡®é€‰æ‹©å¯è·å¾—å€æ•°å¥–åŠ±ï¼Œå†²å‡»æ›´é«˜åˆ†æ•°ï¼<br>
            çœŸæ­£çš„çŠŸè„¾æ°”æµ‹è¯•ï¼Œèƒ†å°å‹¿å…¥ï¼
        </p>
        <button class="start-btn" onclick="startGame()">å¼€å§‹æŒ‘æˆ˜</button>
    </div>

    <div id="gameContainer" style="display: none;">
        <div class="hud">
            <div class="hud-left">
                <div class="hud-item">
                    <div class="hud-label">åˆ†æ•°</div>
                    <div class="hud-value" id="score">0</div>
                </div>
                <div class="hud-item">
                    <div class="hud-label">è¿å‡»</div>
                    <div class="hud-value" id="combo">0</div>
                </div>
                <div class="hud-item">
                    <div class="hud-label">ç­‰çº§</div>
                    <div class="hud-value" id="level">1</div>
                </div>
            </div>
            <div class="hud-center">
                <div class="hud-item">
                    <div class="hud-label">æŒ‘æˆ˜è¿›åº¦</div>
                    <div class="hud-value" id="progress">1 / 10</div>
                </div>
            </div>
            <div class="hud-right">
                <div class="hud-item">
                    <div class="hud-label">AIå¿ƒæƒ…</div>
                    <div class="hud-value" id="aiMood">ğŸ˜Š æ­£å¸¸</div>
                </div>
            </div>
        </div>

        <div class="challenge-area">
            <div class="challenge-text" id="challengeText">
                å‡†å¤‡æ¥å—æŒ‘æˆ˜...
            </div>
            <div class="choices-container" id="choicesContainer">
            </div>
        </div>

        <div class="streak-counter">
            <div class="streak-flame" id="streakFlame">ğŸ”¥</div>
            <div class="streak-text" id="streakText">0</div>
        </div>

        <div class="multiplier" id="multiplier" style="display: none;">
            å€æ•° x<span id="multiplierValue">2</span>
        </div>
    </div>



    <div class="game-over" id="gameOver">
        <div class="game-over-content">
            <div class="final-score" id="finalScore">åˆ†æ•°: 0</div>
            <div id="gameOverTitle" style="font-size: 2em; margin-bottom: 20px;"></div>
            <div id="gameOverStats" style="margin-bottom: 30px;"></div>
            <button class="restart-btn" onclick="restartGame()">é‡æ–°æŒ‘æˆ˜</button>
        </div>
    </div>

    <script>
        const challenges = [
            {
                text: "ğŸš¨ ç´§æ€¥æƒ…å†µï¼æ’é˜Ÿæ—¶æœ‰äººæ’é˜Ÿåˆ°æœ€å‰é¢ï¼",
                choices: [
                    { type: "hard", text: "å¤§å£°åˆ¶æ­¢å¹¶è¦æ±‚ä»–é‡æ–°æ’é˜Ÿ", risk: "high", points: 150 },
                    { type: "compromise", text: "ç¤¼è²Œåœ°æé†’ä»–æ’é˜Ÿè§„åˆ™", risk: "medium", points: 100 },
                    { type: "escape", text: "å‡è£…æ²¡çœ‹è§ç»§ç»­ç­‰å¾…", risk: "low", points: 50 }
                ]
            },
            {
                text: "ğŸ’¼ è€æ¿è¦æ±‚ä½ æ— å¿åŠ ç­å®Œæˆç´§æ€¥ä»»åŠ¡ï¼",
                choices: [
                    { type: "hard", text: "æ˜ç¡®æ‹’ç»å¹¶è¯´æ˜åŠ³åŠ¨æ³•è§„å®š", risk: "high", points: 200 },
                    { type: "compromise", text: "è¦æ±‚åŠ ç­è´¹æˆ–è°ƒä¼‘è¡¥å¿", risk: "medium", points: 120 },
                    { type: "escape", text: "é»˜é»˜æ¥å—å¹¶åŠ ç­å®Œæˆ", risk: "low", points: 60 }
                ]
            },
            {
                text: "ğŸ• å¤–å–é€é”™äº†èœå“ä¸”æ‹’ç»é€€æ¬¾ï¼",
                choices: [
                    { type: "hard", text: "å¨èƒæŠ•è¯‰åˆ°æ¶ˆè´¹è€…åä¼š", risk: "high", points: 180 },
                    { type: "compromise", text: "è¦æ±‚ä¸‹æ¬¡è®¢å•æ‰“æŠ˜è¡¥å¿", risk: "medium", points: 110 },
                    { type: "escape", text: "ç®—äº†ï¼Œåæ­£ä¹Ÿèƒ½åƒ", risk: "low", points: 40 }
                ]
            },
            {
                text: "ğŸ® é˜Ÿå‹åœ¨æ¸¸æˆä¸­æ¶æ„æŒ‚æœºé€äººå¤´ï¼",
                choices: [
                    { type: "hard", text: "ç›´æ¥å¼€éº¦ä¸¥å‰æ‰¹è¯„å¹¶ä¸¾æŠ¥", risk: "high", points: 160 },
                    { type: "compromise", text: "æ‰“å­—æé†’å¹¶å»ºè®®å¥½å¥½ç©", risk: "medium", points: 90 },
                    { type: "escape", text: "é»˜é»˜æ‰¿å—ä¸åšä»»ä½•ååº”", risk: "low", points: 30 }
                ]
            },
            {
                text: "ğŸš— åœè½¦åœºä¿å®‰å¼ºè¡Œæ”¶å–é¢å¤–åœè½¦è´¹ï¼",
                choices: [
                    { type: "hard", text: "åšæŒæŒ‰å…¬ç¤ºä»·æ ¼ä»˜è´¹å¹¶å½•åƒ", risk: "high", points: 190 },
                    { type: "compromise", text: "è®¨ä»·è¿˜ä»·è¾¾æˆä¸€è‡´ä»·æ ¼", risk: "medium", points: 115 },
                    { type: "escape", text: "ä¹–ä¹–æé’±é¿å…éº»çƒ¦", risk: "low", points: 45 }
                ]
            },
            {
                text: "ğŸ—£ï¸ åŒäº‹åœ¨ä¼šè®®ä¸Šæ¶æ„æŠ¹é»‘ä½ çš„å·¥ä½œæˆæœï¼",
                choices: [
                    { type: "hard", text: "å½“åœºæ¿€çƒˆåé©³å¹¶è¦æ±‚é“æ­‰", risk: "high", points: 220 },
                    { type: "compromise", text: "å†·é™ä¸¾è¯æ¾„æ¸…äº‹å®çœŸç›¸", risk: "medium", points: 140 },
                    { type: "escape", text: "æ²‰é»˜åº”å¯¹é¿å…å†²çª", risk: "low", points: 70 }
                ]
            },
            {
                text: "ğŸ’³ é“¶è¡Œä¹±æ”¶è´¹ä¸”æ€åº¦æ¶åŠ£æ‹’ç»è§£é‡Šï¼",
                choices: [
                    { type: "hard", text: "å¨èƒæŠ•è¯‰åˆ°é“¶ä¿ç›‘ä¼š", risk: "high", points: 250 },
                    { type: "compromise", text: "è¦æ±‚è§ç»ç†å¹¶æŠ•è¯‰è¯¥å‘˜å·¥", risk: "medium", points: 130 },
                    { type: "escape", text: "ç®—äº†å°±å½“èŠ±é’±ä¹°æ•™è®­", risk: "low", points: 50 }
                ]
            },
            {
                text: "ğŸ  æ¥¼ä¸Šé‚»å±…æ·±å¤œåˆ¶é€ å™ªéŸ³å±¡åŠä¸æ”¹ï¼",
                choices: [
                    { type: "hard", text: "æŠ¥è­¦å¹¶è”ç³»ç‰©ä¸šå¼ºåˆ¶å¤„ç†", risk: "high", points: 200 },
                    { type: "compromise", text: "å†™æŠ•è¯‰ä¿¡å¹¶è”åˆå…¶ä»–ä¸šä¸»", risk: "medium", points: 125 },
                    { type: "escape", text: "ä¹°è€³å¡ç»§ç»­å¿å—", risk: "low", points: 40 }
                ]
            },
            {
                text: "ğŸ“± æ‰‹æœºåº—é”€å”®æ¬ºè¯ˆéšç’äº§å“ç¼ºé™·ï¼",
                choices: [
                    { type: "hard", text: "è¦æ±‚é€€è´§é€€æ¬¾å¹¶æ›å…‰æ¬ºè¯ˆè¡Œä¸º", risk: "high", points: 280 },
                    { type: "compromise", text: "è¦æ±‚æ›´æ¢åŒæ¬¾æ–°äº§å“", risk: "medium", points: 150 },
                    { type: "escape", text: "è‡ªè®¤å€’éœ‰æ¥å—æœ‰ç¼ºé™·äº§å“", risk: "low", points: 60 }
                ]
            },
            {
                text: "ğŸ”¥ ç»ˆææŒ‘æˆ˜ï¼šæœ‰äººè¯´ä½ 'å¤ªçŠŸäº†'è¦æ±‚æ”¹å˜ï¼",
                choices: [
                    { type: "hard", text: "åšæŒè‡ªæˆ‘æ°¸ä¸å¦¥å", risk: "high", points: 500 },
                    { type: "compromise", text: "é€‚åº¦è°ƒæ•´ä½†ä¿æŒåº•çº¿", risk: "medium", points: 300 },
                    { type: "escape", text: "å®Œå…¨è¿åˆä»–äººæ”¹å˜è‡ªå·±", risk: "low", points: 100 }
                ]
            }
        ];

        let gameState = {
            score: 0,
            combo: 0,
            level: 1,
            difficulty: 1,
            multiplier: 1,
            currentChallenge: 0,
            gameActive: false,
            streakCount: 0,
            totalCorrect: 0,
            aiMood: 'neutral',
            gameSpeed: 1.0,
            specialEvents: []
        };


        let aiFeedback = '';
        let randomEvents = [
            { text: "ğŸ¯ å®Œç¾æ—¶æœºï¼åˆ†æ•°åŒå€ï¼", effect: () => { gameState.multiplier *= 2; } },
            { text: "ğŸ”¥ æ„¤æ€’çˆ†å‘ï¼è¿å‡»é‡ç½®ï¼", effect: () => { gameState.combo = 0; gameState.aiMood = 'angry'; } },
            { text: "ğŸŒŸ å¹¸è¿å¥³ç¥ï¼éšæœºå¥–åŠ±ï¼", effect: () => { gameState.score += Math.floor(Math.random() * 500) + 100; } },
            { text: "ï¿½ï¸ AIä¿æŠ¤ï¼å…ç–«ä¸‹æ¬¡å¤±è´¥ï¼", effect: () => { gameState.aiMood = 'protective'; } },
            { text: "âš¡ é—ªç”µåŠ æˆï¼é¢å¤–åˆ†æ•°ï¼", effect: () => { gameState.score += 200; } }
        ];

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'flex';
            gameState.gameActive = true;
            nextChallenge();
        }

        function nextChallenge() {
            if (gameState.currentChallenge >= challenges.length) {
                endGame();
                return;
            }

            const challenge = challenges[gameState.currentChallenge];
            document.getElementById('challengeText').textContent = challenge.text;
            
            const choicesContainer = document.getElementById('choicesContainer');
            choicesContainer.innerHTML = '';

            challenge.choices.forEach((choice, index) => {
                const card = document.createElement('div');
                card.className = `choice-card choice-${choice.type}`;
                card.innerHTML = `
                    <div class="choice-text">${choice.text}</div>
                    <div class="choice-risk risk-${choice.risk}">
                        é£é™©: ${choice.risk} | åŸºç¡€åˆ†: ${choice.points}
                    </div>
                `;
                card.onclick = () => makeChoice(choice);
                choicesContainer.appendChild(card);
            });

            // æ˜¾ç¤ºæŒ‘æˆ˜è¿›åº¦
            updateProgress();
        }

        function makeChoice(choice) {
            if (!gameState.gameActive) return;


            
            // éšæœºäº‹ä»¶è§¦å‘æ£€æŸ¥
            if (Math.random() < 0.15) { // 15% æ¦‚ç‡è§¦å‘éšæœºäº‹ä»¶
                triggerRandomEvent();
            }
            
            // è®¡ç®—åˆ†æ•°
            let basePoints = choice.points;
            let riskMultiplier = choice.risk === 'high' ? 2.0 : choice.risk === 'medium' ? 1.5 : 1.0;
            
            // è¿å‡»å¥–åŠ±
            gameState.combo++;
            gameState.streakCount++;
            let comboMultiplier = Math.min(1 + (gameState.combo * 0.1), 3.0);
            
            // ç­‰çº§å¥–åŠ±
            let levelMultiplier = 1 + (gameState.level * 0.2);
            
            // AIæƒ…ç»ªå½±å“
            let aiMultiplier = getAIMoodMultiplier();
            
            let finalPoints = Math.floor(basePoints * riskMultiplier * comboMultiplier * levelMultiplier * aiMultiplier);
            gameState.score += finalPoints;
            
            // æ£€æŸ¥å‡çº§
            checkLevelUp();
            
            // æ£€æŸ¥å€æ•°å¥–åŠ±
            if (gameState.combo >= 5) {
                gameState.multiplier = Math.min(2 + Math.floor(gameState.combo / 5), 5);
                showMultiplier();
            }

            // è¿å‡»å¥–åŠ±æ•ˆæœ
            if (gameState.combo >= 3 && gameState.combo % 3 === 0) {
                gameState.score += 100; // è¿å‡»å¥–åŠ±åˆ†æ•°
                showStreakBonus();
            }

            // è·å–AIæ™ºèƒ½åé¦ˆ
            getAIFeedback(choice);
            
            playChoiceSound(choice.type, choice.risk);
            
            // æ˜¾ç¤ºé€‰æ‹©ç»“æœåé¦ˆ
            showChoiceFeedback(choice, finalPoints);

            gameState.currentChallenge++;
            
            setTimeout(() => {
                nextChallenge();
            }, 1500);
        }

        function getAIMoodMultiplier() {
            switch(gameState.aiMood) {
                case 'angry': return 0.8; // AIæ„¤æ€’æ—¶é™ä½å¥–åŠ±
                case 'protective': return 1.5; // AIä¿æŠ¤æ—¶å¢åŠ å¥–åŠ±
                case 'excited': return 1.3; // AIå…´å¥‹æ—¶å¢åŠ å¥–åŠ±
                case 'disappointed': return 0.9; // AIå¤±æœ›æ—¶é™ä½å¥–åŠ±
                default: return 1.0;
            }
        }

        function getAIFeedback(choice) {
            // æ¨¡æ‹ŸAIåˆ†æç³»ç»Ÿ
            const aiPersonalities = [
                'strict_mentor', 'cheerful_supporter', 'sarcastic_commentator', 'wise_counselor'
            ];
            
            const selectedAI = aiPersonalities[Math.floor(Math.random() * aiPersonalities.length)];
            let feedback = '';
            
            switch(selectedAI) {
                case 'strict_mentor':
                    if (choice.type === 'hard') {
                        feedback = choice.risk === 'high' ? 
                            'ğŸ’ª å¾ˆå¥½çš„åšæŒï¼ä½†è¦å­¦ä¼šæ§åˆ¶é£é™©ã€‚' : 
                            'ğŸ‘ åšæŒåŸåˆ™æ˜¯å¯¹çš„ï¼Œä½†è¦æ›´å‹‡æ•¢ä¸€äº›ã€‚';
                    } else if (choice.type === 'compromise') {
                        feedback = 'ğŸ¤ æ™ºæ…§çš„é€‰æ‹©ï¼å¹³è¡¡å¾ˆé‡è¦ã€‚';
                    } else {
                        feedback = 'ğŸ˜Œ é€ƒé¿ä¸æ˜¯é•¿ä¹…ä¹‹è®¡ï¼Œè¦å­¦ä¼šé¢å¯¹ã€‚';
                    }
                    break;
                    
                case 'cheerful_supporter':
                    if (choice.type === 'hard') {
                        feedback = choice.risk === 'high' ? 
                            'ğŸ”¥ å¤ªæ£’äº†ï¼è¿™å°±æ˜¯å‹‡æ°”ï¼ç»§ç»­åŠ æ²¹ï¼' : 
                            'ğŸ’ª å¾ˆå¥½çš„åšæŒï¼ä¸ºä½ éª„å‚²ï¼';
                    } else if (choice.type === 'compromise') {
                        feedback = 'ğŸŒŸ èªæ˜çš„é€‰æ‹©ï¼å’Œè°ä¸‡å²ï¼';
                    } else {
                        feedback = 'ğŸ˜Š æ²¡å…³ç³»ï¼Œä¸‹æ¬¡å¯ä»¥æ›´å‹‡æ•¢ä¸€ç‚¹ï¼';
                    }
                    break;
                    
                case 'sarcastic_commentator':
                    if (choice.type === 'hard') {
                        feedback = choice.risk === 'high' ? 
                            'ğŸ˜ å“‡ï¼ŒçœŸå‹‡æ•¢ï¼ä¸è¿‡å°å¿ƒåˆ«æŠŠæˆ¿å­çƒ§äº†ã€‚' : 
                            'ğŸ˜ è¿˜ä¸é”™ï¼Œè‡³å°‘æ²¡æ€‚ã€‚';
                    } else if (choice.type === 'compromise') {
                        feedback = 'ğŸ¤·â€â™‚ï¸ å…¸å‹çš„å’Œäº‹ä½¬ï¼Œä¸è¿‡ä¹Ÿè¿˜è¡Œå§ã€‚';
                    } else {
                        feedback = 'ğŸ˜´ åˆæ¥è¿™å¥—ï¼Ÿä½ çš„å‹‡æ°”è¢«ç‹—åƒäº†å—ï¼Ÿ';
                    }
                    break;
                    
                case 'wise_counselor':
                    if (choice.type === 'hard') {
                        feedback = choice.risk === 'high' ? 
                            'âš–ï¸ åšæŒåŸåˆ™å€¼å¾—èµèµï¼Œä½†è¦å®¡æ—¶åº¦åŠ¿ã€‚' : 
                            'ğŸ¯ ä½ çš„åšæŒä½“ç°äº†ä»·å€¼è§‚ï¼Œå¾ˆå¥½ã€‚';
                    } else if (choice.type === 'compromise') {
                        feedback = 'ğŸŒŠ é¡ºåº”æ—¶åŠ¿ï¼Œæ™ºæ…§çš„é€‰æ‹©ã€‚';
                    } else {
                        feedback = 'ğŸ•Šï¸ æœ‰æ—¶é€€è®©ä¹Ÿæ˜¯ä¸€ç§ç­–ç•¥ï¼Œä½†è¦é€‚åº¦ã€‚';
                    }
                    break;
            }
            
            // æ ¹æ®è¿å‡»æ•°è°ƒæ•´åé¦ˆ
            if (gameState.combo >= 10) {
                feedback += ' ğŸ”¥ è¿å‡»' + gameState.combo + 'ï¼ä½ çš„çŠ¶æ€å¤ªæ£’äº†ï¼';
            } else if (gameState.combo >= 5) {
                feedback += ' âš¡ è¿ç»­æ­£ç¡®ï¼ä¿æŒè¿™ä¸ªåŠ¿å¤´ï¼';
            }
            
            aiFeedback = feedback;
            showAIFeedback(feedback);
        }

        function showAIFeedback(feedback) {
            const aiComment = document.createElement('div');
            aiComment.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.8);
                color: #4ECDC4;
                padding: 15px 30px;
                border-radius: 25px;
                font-size: 1em;
                font-style: italic;
                z-index: 999;
                max-width: 80%;
                text-align: center;
                border: 2px solid #4ECDC4;
                animation: aiCommentSlide 3s ease-in-out;
            `;
            aiComment.textContent = 'ğŸ¤– AI: ' + feedback;
            
            document.body.appendChild(aiComment);
            
            setTimeout(() => {
                aiComment.remove();
            }, 3000);
        }

        function triggerRandomEvent() {
            const event = randomEvents[Math.floor(Math.random() * randomEvents.length)];
            
            const eventOverlay = document.createElement('div');
            eventOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1001;
                animation: eventFlash 0.5s ease-out;
            `;
            
            const eventBox = document.createElement('div');
            eventBox.style.cssText = `
                background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
                padding: 30px;
                border-radius: 20px;
                text-align: center;
                color: white;
                font-size: 1.5em;
                font-weight: bold;
                animation: eventPop 1s ease-out;
                border: 3px solid white;
            `;
            
            eventBox.innerHTML = `
                <div style="font-size: 2em; margin-bottom: 15px;">${event.text}</div>
                <div style="font-size: 0.7em; opacity: 0.9;">AIè§¦å‘ç‰¹æ®Šäº‹ä»¶</div>
            `;
            
            eventOverlay.appendChild(eventBox);
            document.body.appendChild(eventOverlay);
            
            // æ‰§è¡Œäº‹ä»¶æ•ˆæœ
            setTimeout(() => {
                event.effect();
                updateTimerDisplay();
            }, 500);
            
            setTimeout(() => {
                eventOverlay.remove();
            }, 2000);
        }

        function showChoiceFeedback(choice, points) {
            const feedback = document.createElement('div');
            feedback.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                padding: 20px 40px;
                border-radius: 15px;
                font-size: 1.5em;
                font-weight: bold;
                z-index: 1000;
                animation: feedbackPop 1.5s ease-out;
                border: 2px solid ${choice.type === 'hard' ? '#ff4757' : choice.type === 'compromise' ? '#ffa502' : '#3742fa'};
            `;
            
            let resultText = '';
            switch(choice.type) {
                case 'hard':
                    resultText = choice.risk === 'high' ? 'ğŸ”¥ ç¡¬åˆšæˆåŠŸï¼' : 'ğŸ’ª åšæŒåŸåˆ™ï¼';
                    break;
                case 'compromise':
                    resultText = 'ğŸ¤ æ™ºæ…§å¦¥åï¼';
                    break;
                case 'escape':
                    resultText = 'ğŸ˜Œ é¿å…å†²çªï¼';
                    break;
            }
            
            feedback.innerHTML = `
                <div>${resultText}</div>
                <div style="font-size: 0.8em; margin-top: 10px; color: #ffa502;">
                    +${points} åˆ† | è¿å‡»: ${gameState.combo}
                </div>
            `;
            
            document.body.appendChild(feedback);
            
            setTimeout(() => {
                feedback.remove();
            }, 1500);
        }

        function checkLevelUp() {
            const newLevel = Math.floor(gameState.score / 1000) + 1;
            if (newLevel > gameState.level) {
                gameState.level = newLevel;
                gameState.difficulty = newLevel;
                showLevelUp();
            }
        }

        function showLevelUp() {
            const levelUp = document.createElement('div');
            levelUp.className = 'level-up';
            levelUp.innerHTML = `
                ğŸš€ ç­‰çº§æå‡ï¼
                <div style="font-size: 0.8em; margin-top: 10px;">
                    ç­‰çº§ ${gameState.level} | éš¾åº¦å¢åŠ 
                </div>
            `;
            
            document.body.appendChild(levelUp);
            
            setTimeout(() => {
                levelUp.remove();
            }, 2000);
        }

        function showMultiplier() {
            const multiplier = document.getElementById('multiplier');
            const multiplierValue = document.getElementById('multiplierValue');
            
            multiplierValue.textContent = gameState.multiplier;
            multiplier.style.display = 'block';
            
            setTimeout(() => {
                multiplier.style.display = 'none';
            }, 3000);
        }

        function updateProgress() {
            const progressElement = document.getElementById('progress');
            if (progressElement) {
                progressElement.textContent = `${gameState.currentChallenge + 1} / ${challenges.length}`;
            }
        }

        function showStreakBonus() {
            const streakBonus = document.createElement('div');
            streakBonus.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(45deg, #2ed573, #20bf6b);
                color: white;
                padding: 20px 40px;
                border-radius: 15px;
                font-size: 1.5em;
                font-weight: bold;
                z-index: 1000;
                animation: streakPop 2s ease-out;
                border: 3px solid #fff;
            `;
            streakBonus.innerHTML = `
                <div style="font-size: 2em;">ğŸ”¥</div>
                <div>è¿å‡»å¥–åŠ±ï¼+100åˆ†ï¼</div>
            `;
            
            document.body.appendChild(streakBonus);
            
            setTimeout(() => {
                streakBonus.remove();
            }, 2000);
        }

        function endGame() {
            gameState.gameActive = false;
            
            document.getElementById('finalScore').textContent = `æœ€ç»ˆåˆ†æ•°: ${gameState.score}`;
            
            let title, description;
            if (gameState.score >= 3000) {
                title = "ğŸ‘‘ çŠŸè„¾æ°”ä¹‹ç‹ï¼";
                description = "ä½ æ˜¯çœŸæ­£çš„çŠŸè„¾æ°”ä¼ è¯´ï¼æ— è®ºé¢å¯¹ä»€ä¹ˆæŒ‘æˆ˜éƒ½åšæŒåˆ°åº•ï¼";
            } else if (gameState.score >= 2000) {
                title = "ğŸ”¥ ç¡¬åˆšä¸“å®¶ï¼";
                description = "ä½ çš„åšæŒç²¾ç¥ä»¤äººæ•¬ä½©ï¼åœ¨å…³é”®æ—¶åˆ»ç»ä¸å¦¥åï¼";
            } else if (gameState.score >= 1000) {
                title = "âš–ï¸ å¹³è¡¡å¤§å¸ˆï¼";
                description = "ä½ åœ¨åšæŒå’Œå¦¥åä¹‹é—´æ‰¾åˆ°äº†å®Œç¾çš„å¹³è¡¡ç‚¹ï¼";
            } else {
                title = "ğŸŒŠ æ¸©å’Œæ´¾ï¼";
                description = "ä½ æ›´å€¾å‘äºå’Œè°è§£å†³é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§æ™ºæ…§ï¼";
            }
            
            document.getElementById('gameOverTitle').textContent = title;
            document.getElementById('gameOverStats').innerHTML = `
                <div>æœ€é«˜è¿å‡»: ${gameState.streakCount}</div>
                <div>æœ€ç»ˆç­‰çº§: ${gameState.level}</div>
                <div>æŒ‘æˆ˜å®Œæˆ: ${gameState.currentChallenge}/10</div>
            `;
            
            document.getElementById('gameOver').style.display = 'flex';
        }

        function restartGame() {
            gameState = {
                score: 0,
                combo: 0,
                level: 1,
                difficulty: 1,
                multiplier: 1,
                currentChallenge: 0,
                gameActive: false,
                streakCount: 0,
                totalCorrect: 0,
                aiMood: 'neutral',
                gameSpeed: 1.0,
                specialEvents: []
            };
            
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('startScreen').style.display = 'flex';
        }

        // éŸ³æ•ˆç³»ç»Ÿ
        let audioContext;
        let soundEnabled = true;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(frequency, duration, type = 'sine') {
            if (!soundEnabled) return;
            
            try {
                initAudio();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (e) {
                console.log('éŸ³æ•ˆæ’­æ”¾å¤±è´¥:', e);
            }
        }

        function playChoiceSound(choiceType, risk) {
            let baseFreq = choiceType === 'hard' ? 200 : choiceType === 'compromise' ? 400 : 600;
            let riskBoost = risk === 'high' ? 100 : risk === 'medium' ? 50 : 0;
            
            playSound(baseFreq + riskBoost, 0.3, choiceType === 'hard' ? 'sawtooth' : 'sine');
            
            if (choiceType === 'hard' && risk === 'high') {
                setTimeout(() => playSound(baseFreq + riskBoost + 50, 0.2, 'sawtooth'), 100);
            }
        }

        function playTimeUpSound() {
            playSound(150, 0.5, 'sawtooth');
            setTimeout(() => playSound(100, 0.3, 'sawtooth'), 200);
        }

        function playLevelUpSound() {
            playSound(400, 0.2, 'sine');
            setTimeout(() => playSound(500, 0.2, 'sine'), 200);
            setTimeout(() => playSound(600, 0.2, 'sine'), 400);
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”¥ çŠŸè„¾æ°”ç”Ÿå­˜æŒ‘æˆ˜å·²åŠ è½½ï¼');
        });
    </script>
</body>
</html>